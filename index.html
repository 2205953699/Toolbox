<!DOCTYPE html>
<html lang="zh">
<head>
  <meta charset="UTF-8">
  <meta name="viewport" content="width=device-width, initial-scale=1.0">
  <title>工具合集</title>
  <style>
    body {
      font-family: Arial, sans-serif;
      background: #f9f9f9;
      margin: 0;
      padding: 20px;
      color: #333;
    }
    .nav {
      text-align: center;
      margin-bottom: 20px;
    }
    .nav button {
      padding: 10px 20px;
      margin: 5px;
      border: none;
      border-radius: 6px;
      background-color: #007bff;
      color: white;
      cursor: pointer;
      transition: background 0.3s;
    }
    .nav button:hover {
      background-color: #0056b3;
    }
    .section {
      display: none;
      max-width: 600px;
      margin: auto;
      background: white;
      padding: 20px;
      border-radius: 8px;
      box-shadow: 0 0 10px rgba(0,0,0,0.1);
    }
    .section.active {
      display: block;
    }
    textarea, input {
      width: 100%;
      padding: 10px;
      margin: 8px 0;
      border: 1px solid #ccc;
      border-radius: 4px;
      box-sizing: border-box;
    }
    button.action {
      background-color: #28a745;
      margin-top: 10px;
    }
    button.action:hover {
      background-color: #1e7e34;
    }
    ul {
      list-style: none;
      padding: 0;
    }
    .url-item {
      padding: 5px;
    }
    .url-item a {
      text-decoration: none;
      color: #007bff;
      word-break: break-all;
    }
    .url-item a:hover {
      text-decoration: underline;
    }
    .visited {
      color: red;
    }
    #userAgent {
      margin: 15px 0;
      padding: 10px;
      background: #f4f4f4;
      border-radius: 4px;
      font-family: monospace;
      word-break: break-all;
    }
  </style>
</head>
<body>
  <div class="nav">
    <button onclick="showSection('auth')">2FA Auth</button>
    <button onclick="showSection('check')">检查存活</button>
    <button onclick="showSection('converter')">URLConverter</button>
    <button onclick="showSection('ua')">User-Agent Generator</button>
  </div>

  <!-- 2FA Auth -->
  <div id="auth" class="section active">
    <h2>2FA Auth</h2>
    <input type="text" id="keyInput" placeholder="输入你的密钥">
    <button class="action" onclick="generateOTP()">生成验证码</button>
    <input type="text" id="otp" readonly>
    <button class="action" onclick="copyOTP()">复制验证码</button>
  </div>

  <!-- 检查存活 -->
  <div id="check" class="section">
    <h2>检查存活</h2>
    <textarea id="checklist" rows="8" placeholder="输入检查ID，每行一个"></textarea>
    <button class="action" id="checkliveuid">检查存活</button>
    <button class="action" onclick="document.getElementById('checklist').value=''">清空</button>
    <h3>好ID</h3>
    <textarea id="checklistlive" rows="6" placeholder="好ID在这"></textarea>
    <button class="action" id="copyok">复制好ID</button>
    <h3>坏ID</h3>
    <textarea id="checklistdie" rows="6" placeholder="坏ID在这"></textarea>
    <button class="action" id="copyno">复制坏ID</button>
  </div>

  <!-- URL Converter -->
  <div id="converter" class="section">
    <h2>URLConverter</h2>
    <textarea id="urlInput" rows="8" placeholder="输入多个URL，每行一个"></textarea>
    <button class="action" onclick="convertURLs()">Conversion</button>
    <button class="action" onclick="openAllURLs()">一键打开全部</button>
    <ul id="output"></ul>
  </div>

  <!-- User-Agent Generator -->
  <div id="ua" class="section">
    <h2>User-Agent Generator</h2>
    <div id="userAgent">点击按钮生成 User-Agent</div>
    <button class="action" onclick="generateUserAgent()">生成 User-Agent</button>
    <button class="action" onclick="copyToClipboard()">复制到剪贴板</button>
  </div>

  <script>
    // 切换显示
    function showSection(id) {
      document.querySelectorAll('.section').forEach(sec => sec.classList.remove('active'));
      document.getElementById(id).classList.add('active');
    }

    // 2FA OTP
    async function generateOTP() {
      const key = document.getElementById('keyInput').value.trim();
      if (!key) return;
      const otp = await calculateTOTP(key);
      document.getElementById('otp').value = otp;
    }
    async function calculateTOTP(key) {
      const keyBytes = base32ToBytes(key);
      const time = Math.floor(Date.now() / 1000 / 30);
      const timeBytes = new Uint8Array(8);
      let t = time;
      for (let i = 0; i < 8; i++) { timeBytes[7 - i] = t & 0xff; t >>= 8; }
      const hmac = await createHmac('SHA-1', keyBytes, timeBytes);
      const offset = hmac[hmac.length - 1] & 0xf;
      const bin = ((hmac[offset] & 0x7f) << 24) |
                  ((hmac[offset+1] & 0xff) << 16) |
                  ((hmac[offset+2] & 0xff) << 8) |
                  (hmac[offset+3] & 0xff);
      return (bin % 1000000).toString().padStart(6, '0');
    }
    function base32ToBytes(base32) {
      const chars = 'ABCDEFGHIJKLMNOPQRSTUVWXYZ234567';
      const bytes = []; let buf = 0, bits = 0;
      for (const c of base32) {
        const val = chars.indexOf(c.toUpperCase());
        if (val === -1) continue;
        buf = (buf << 5) | val; bits += 5;
        if (bits >= 8) { bits -= 8; bytes.push((buf >> bits) & 0xff); }
      }
      return new Uint8Array(bytes);
    }
    async function createHmac(alg, keyBytes, dataBytes) {
      const key = await crypto.subtle.importKey('raw', keyBytes, {name:'HMAC',hash:{name:alg}}, false, ['sign']);
      const sig = await crypto.subtle.sign('HMAC', key, dataBytes);
      return new Uint8Array(sig);
    }
    function copyOTP() {
      const otp = document.getElementById('otp');
      otp.select();
      document.execCommand('copy');
    }

    // URL Converter
    function convertURLs() {
      const input = document.getElementById("urlInput").value.split("\n");
      const output = document.getElementById("output");
      let html = "";
      input.forEach(url => {
        url = url.trim();
        if (url) html += `<li class="url-item"><a href="${url}" target="_blank" onclick="markVisited(this)">${url}</a></li>`;
      });
      output.innerHTML = html;
    }
    function markVisited(el) { el.classList.add("visited"); }
    function openAllURLs() {
      document.querySelectorAll("#output a").forEach(a => window.open(a.href));
    }

    // User-Agent Generator
    function generateUserAgent() {
      const osTypes = {
        Windows: ['11'], macOS: ['13.0'], Linux: ['latest'],
        Android: ['13.0'], iOS: ['17.0'], "Chrome OS": ['latest']
      };
      const browsers = {
        Firefox: ['115.0','116.0','117.0'],
        Chrome: ['115.0','116.0','117.0'],
        Safari: ['16.6','16.7'],
        Edge: ['115.0','116.0','117.0']
      };
      const os = rand(Object.keys(osTypes));
      const browser = rand(Object.keys(browsers));
      const ua = os==="Android"||os==="iOS"
        ? `Mozilla/5.0 (${os} ${rand(osTypes[os])}; Mobile; rv:${rand(browsers[browser])}) Gecko ${browser}/${rand(browsers[browser])}`
        : `Mozilla/5.0 (${os} ${rand(osTypes[os])}; x86_64) ${browser}/${rand(browsers[browser])}`;
      document.getElementById('userAgent').textContent = ua;
    }
    function rand(arr){ return arr[Math.floor(Math.random()*arr.length)]; }
    function copyToClipboard() {
      const text = document.getElementById('userAgent').textContent;
      const ta = document.createElement('textarea');
      ta.value = text; document.body.appendChild(ta);
      ta.select(); document.execCommand('copy');
      document.body.removeChild(ta);
    }
  </script>
</body>
</html>
